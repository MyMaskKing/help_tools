# WPS云文档数据表任务邮件提醒

这是一个基于WPS云文档Python脚本功能的脚本，用于查询数据表中的今日待办任务，并通过HTTP POST请求发送到163邮箱。

## 功能特点

- 自动查询当天未完成的任务
- 生成美观的HTML邮件，包含任务列表和链接
- 通过HTTP POST请求发送邮件，无需SMTP配置

## 使用前提

1. 您需要在WPS云文档中创建一个数据表文档，包含以下字段：
   - 日期字段：用于筛选当天任务
   - 任务标识字段：用于标记任务（值为1表示是任务）
   - 完成状态字段：用于筛选未完成任务（值为0表示未完成）
   - 今天要做什么事：记录任务的具体内容
   - 当前数据的链接：任务相关的链接

## 脚本说明

脚本会自动执行以下操作：
1. 使用`dbt`函数查询数据表中符合条件的记录
2. 生成HTML格式的邮件内容
3. 通过HTTP POST请求发送到指定的邮箱服务（默认为https://mail.163.com/）

## 使用方法

1. 在WPS云文档中打开您的数据表文件
2. 选择顶部菜单的"效率" > "PY脚本"（在表格或智能表格中）或"脚本" > "PY脚本"（在多维表格中）
3. 创建新脚本
4. 将`wps_task_query.py`的内容复制到脚本编辑器中
5. 修改收件人邮箱地址（在代码中的`send_mail_post`函数调用部分）
6. 运行脚本

## 注意事项

- 脚本中使用的`dbt`函数是WPS云文档环境中提供的内置函数，无需导入
- 目前脚本默认发送到163邮箱，如需更改，请修改`send_mail_post`函数的`mail_url`参数
- 字段名称需要与脚本中的设置一致，默认为"日期"、"任务标识"、"完成状态"、"今天要做什么事"和"当前数据的链接"
- 邮件发送使用的是HTTP POST请求，实际应用中可能需要根据邮箱服务商的API进行调整